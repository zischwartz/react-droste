{"version":3,"sources":["../../src/index.js","App.js","index.js"],"names":["Droste","props","canvasRef","useRef","ttl","element","document","useEffect","throttledGetDocData","rafSchd","scrollX","window","scrollY","removeContainer","inner_width","inner_height","x","y","final_config","width","height","ctx","html2canvas","timeout","setInterval","clearTimeout","ref","get_wh","w","Math","round","random","h","App","useState","isFixed","setIsFixed","id","className","lorem","src","alt","Kitten","onClick","config","useCORS","scale","exampleState","setExampleState","is_active_cn","ReactDOM","render","getElementById"],"mappings":"ybAQaA,EAAS,SAACC,GACrB,IAAMC,EAAYC,iBAAlB,MACMC,EAAMH,OAAZ,IACMI,EAAUJ,WAAiBK,SAAjC,KA6CA,OA5CAC,qBAAU,WAAM,IAkCRC,EAAsBC,aAlCd,eAGZ,IAAMC,EAAUT,kBAAwBU,OAAxC,YACMC,EAAUX,kBAAwBU,OAAxC,YACME,EAA2BZ,SAAjC,gBACMa,EAAcb,gBAAsBU,OAA1C,WACMI,EAAed,iBAAuBU,OAA5C,YACMK,EAAIf,YAAkBU,OAA5B,YACMM,EAAIhB,YAAkBU,OAA5B,YACMO,EAAe,EAAH,GACbjB,EADa,QAEhBkB,MAFgB,EAGhBC,OAHgB,EAIhBV,QAJgB,EAKhBE,QALgB,EAMhBC,gBANgB,EAOhBG,EAPgB,EAQhBC,MAKII,EAAMnB,qBAAZ,MArB0B,uBAyBDoB,IAAYjB,EAzBX,sBA2B1BgB,qBACAA,sBA9BY,sCAqCRE,EAAUC,YAAYhB,EAA5B,GACA,OAAO,WACLiB,mBAvCJlB,IA6CE,6BACE,4BAAQmB,IAAR,EAAwBP,MAAOlB,EAA/B,MAA4CmB,OAAQnB,EAAMmB,W,MClBhE,SAASO,IAGP,MAAO,CAAEC,EAFDC,KAAKC,MAAsB,IAAhBD,KAAKE,SAAiB,KAE7BC,EADJH,KAAKC,MAAsB,IAAhBD,KAAKE,SAAiB,MAI5BE,MAvCH,KAAM,QAEcC,oBAAS,GAFvB,mBAETC,EAFS,KAEAC,EAFA,KAKhB,OACE,yBAAKC,GAAG,QACN,yBAAKC,UAAU,OACb,2CACA,2BAAIC,GACJ,yBAAKC,IAAI,aAAaC,IAAI,mBAC1B,kBAACC,EAAWf,KACZ,yBACEgB,QAAS,IAAMP,GAAYD,GAC3BE,GAAG,sBACHC,UAAWH,EAAU,WAAa,IAElC,kBAAC,EAAD,CAAQS,OAhBH,CAAEC,SAAS,EAAMC,MAAO,IAgBL3B,MAAO,IAAKC,OAAQ,OAE9C,kBAACsB,EAAWf,KAEZ,2BAAIY,EAAQA,EAAQA,GACpB,kBAACG,EAAWf,KAEZ,2BAAIY,EAAQA,GACZ,kBAACG,EAAWf,KAEZ,2BAAIY,EAAQA,EAAQA,EAAQA,EAAQA,MAc5C,SAASG,EAAOzC,GAAQ,MACd2B,EAAS3B,EAAT2B,EAAGI,EAAM/B,EAAN+B,EADU,EAImBE,oBAAS,GAJ5B,mBAIda,EAJc,KAIAC,EAJA,KAKrB,IAAIC,EAAeF,EAAe,SAAW,GACzCP,EAAG,kCAA8BZ,EAA9B,YAAmCI,GAC1C,OACE,yBACEQ,IAAKA,EACLrB,MAAOS,EACPR,OAAQY,EACRS,IAAI,SACJH,UAAS,iBAAYW,GACrBN,QAAS,IAAMK,GAAiBD,KAQtC,MAAMR,EAAK,mWChEXW,IAASC,OAAO,kBAAC,EAAD,MAAS7C,SAAS8C,eAAe,U","file":"static/js/main.a278f39b.chunk.js","sourcesContent":["import React, { useRef, useEffect } from 'react'\n\n// import styles from './styles.module.css'\nimport html2canvas from 'html2canvas'\nimport rafSchd from 'raf-schd'\n\n// http://html2canvas.hertzen.com/configuration/\n\nexport const Droste = (props) => {\n  const canvasRef = useRef(null)\n  const ttl = props.ttl || 500\n  const element = props.element || document.body\n  useEffect(() => {\n    // Create an scoped async function in the hook\n    async function getDocData() {\n      const scrollX = props.config.scrollX || window.pageXOffset\n      const scrollY = props.config.scrollY || window.pageYOffset\n      const removeContainer = false || props.config.removeContainer\n      const inner_width = props.config.width || window.innerWidth\n      const inner_height = props.config.height || window.innerHeight\n      const x = props.config.x || window.pageXOffset\n      const y = props.config.y || window.pageYOffset\n      const final_config = {\n        ...props.config,\n        width: inner_width,\n        height: inner_height,\n        scrollX,\n        scrollY,\n        removeContainer,\n        x,\n        y\n      }\n      // XXX this is probably a better way to do this, by passing the canvasref in the config\n      // canvas: canvasRef.current\n\n      const ctx = canvasRef.current.getContext('2d')\n      // ctx.clearRect(0, 0, width, height)\n      // console.log('go')\n\n      let sourceCanvas = await html2canvas(element, final_config)\n\n      ctx.clearRect(0, 0, inner_width, inner_height)\n      ctx.drawImage(sourceCanvas, 0, 0)\n    }\n    // this returns a function that only runs at max as often as RAF\n    // (so it won't happen if the page isn't focussed)\n    const throttledGetDocData = rafSchd(getDocData)\n    // which we further throttle massively with ttl in ms\n    // this returns the interval id, which we use below to cancel it on unmount\n    const timeout = setInterval(throttledGetDocData, ttl)\n    return () => {\n      clearTimeout(timeout)\n    }\n\n    getDocData()\n  }, [])\n  return (\n    <div>\n      <canvas ref={canvasRef} width={props.width} height={props.height} />\n    </div>\n  )\n}\n","import React, { useState } from 'react'\n\nimport { Droste } from 'react-droste'\nimport 'react-droste/dist/index.css'\n\n// http://html2canvas.hertzen.com/configuration/\n\nconst App = () => {\n  let config = { useCORS: true, scale: 0.5 }\n  const [isFixed, setIsFixed] = useState(false)\n\n  // let config = {}\n  return (\n    <div id='wrap'>\n      <div className='col'>\n        <h1>Hello world</h1>\n        <p>{lorem}</p>\n        <img src='droste.png' alt='droste package' />\n        <Kitten {...get_wh()} />\n        <div\n          onClick={() => setIsFixed(!isFixed)}\n          id='droste_example_wrap'\n          className={isFixed ? 'is_fixed' : ''}\n        >\n          <Droste config={config} width={300} height={400} />\n        </div>\n        <Kitten {...get_wh()} />\n\n        <p>{lorem + lorem + lorem}</p>\n        <Kitten {...get_wh()} />\n\n        <p>{lorem + lorem}</p>\n        <Kitten {...get_wh()} />\n\n        <p>{lorem + lorem + lorem + lorem + lorem}</p>\n      </div>\n    </div>\n  )\n}\n\nfunction get_wh() {\n  let w = Math.round(Math.random() * 300 + 100)\n  let h = Math.round(Math.random() * 300 + 100)\n  return { w, h }\n}\n\nexport default App\n\nfunction Kitten(props) {\n  const { w, h } = props\n\n  // console.log(src)\n  const [exampleState, setExampleState] = useState(false)\n  let is_active_cn = exampleState ? 'active' : ''\n  let src = `https://placekitten.com/${w}/${h}`\n  return (\n    <img\n      src={src}\n      width={w}\n      height={h}\n      alt='kitten'\n      className={`kitten ${is_active_cn}`}\n      onClick={() => setExampleState(!exampleState)}\n    />\n  )\n}\n\n// consectetur adipisicing elit, sed do eiusmod\n// tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim\n\nconst lorem = `Velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint\noccaecat cupidatat non proident, sunt in culpa qui officia deserunt\nmollit anim id est laborum. consectetur adipisicing elit, sed do eiusmod veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea\ncommodo consequat. Duis aute irure dolor in reprehenderit in voluptate`\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}